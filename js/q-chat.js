const _0x2ccb0c=_0x3b92;function _0x2e85(){const _0x5804f0=['parse','qchatJoin','50%','toggleBtn','retryWithRelayMode','openPanel','keypress','30mFDVBY','random','Q-Chat:\x20Received\x20retry-relay\x20signal\x20from\x20peer','ondatachannel','floor','Failed\x20to\x20send\x20message','qchatMessages','inputSection','peer-joined','411215DGsbKH','peer-left','open','cos','preventDefault','showChatUI','select','stun:stun.l.google.com:19302','Q-Chat:\x20Error\x20handling\x20offer:','qchatClose','removeChild','disableChat','Q-Chat:\x20Connection\x20timeout\x20-\x20may\x20be\x20behind\x20VPN','messagesList','99+','5912TsiOgM','Q-Chat:\x20Connecting\x20to:','marginLeft','handleRetryRelay','Failed\x20to\x20connect\x20to\x20server','connected','click','connectionTimeout','focus','toLocaleTimeString','updateBadge','add','display','handleIceCandidate','roomCodeEl','connecting','Connection\x20setup\x20failed','substring','type','qchatBadge','receiveMessage','roomInfoSection','connectionState','location','timestamp','stun:stun1.l.google.com:19302','Q-Chat:\x20Using\x20cached\x20ICE\x20servers\x20for\x20retry','url','contains','Q-Chat:\x20Creating\x20and\x20sending\x20offer...','roomId','2-digit','Q-Chat:\x20ICE\x20connection\x20state:','value','acos','connectToServer','onopen','textContent','message','none','777252icEHVj','flex','onconnectionstatechange','cachedIceServers','error','maxConnectionAttempts','log','454370xDfViM','Enter','Encrypting\x20Neural\x20Pathway...','disabled','getWebSocketUrl','/api/turn-credentials','Room\x20code\x20copied!','handleDisconnect','sdp','addMessage','setLocalDescription','style','clipboard','px)','Direct\x20connection\x20failed,\x20trying\x20VPN-compatible\x20mode...','length','createDataChannel','enableChat','qchatInputSection','onicecandidate','scrollTop','now','onmessage','setRemoteDescription','statusEl','605SNjjfA','qchat-system-message','unreadCount','qchatCreate','panel','3253716LDXlEk','Q-Chat:\x20ICE\x20Server\x20','host','messagesSection','qchatStatus','Peer\x20left','ws:','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22qchat-message-text\x22>','qchatWaiting','isArray','wss:','close','body','Joined\x20room!\x20Waiting\x20for\x20host...','qchatRoomInfo','send','updateStatus','createRoom','innerHTML','getElementById','addEventListener','connectSection','div','createElement','failed','qchat-status\x20','urls','connectionAttempt','ðŸ”’\x20Secure\x20connection\x20established\x20via\x20relay\x20(VPN\x20mode)','messageInput','block','relay','left','active','then','setupDataChannel','map','Q-Chat:\x20ICE\x20gathering\x20complete','\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20','dataChannel','createBtn','isHost','Q-Chat:\x20Offer\x20sent','joinRoom','Finalizing\x20Quantum\x20Code...','addIceCandidate','initializeWebRTC','closePanel','translate3d(','data','sendBtn','265mBtydJ','sin','Disconnected','clearUnread','copyCodeBtn','copy','qChat','top','forceRelayMode','24nGrmvx','Q-Chat:\x20WebSocket\x20error:','sendMessage','peerConnection','candidate','key','/ws','Q-Chat\x20Server\x20Error:','ice-candidate','Q-Chat:\x20Received\x20ICE\x20candidate:','closeBtn','isPanelOpen','initElements','disconnected','qchatMessageInput','answer','escapeHtml','charAt','isConnected','classList','1083615VNJiEX','onicegatheringstatechange','showRoomInfo','Q-Chat:\x20WebSocket\x20closed','Joining...','Q-Chat:\x20Invalid\x20TURN\x20response,\x20using\x20STUN\x20fallback','createAnswer','Error','retry-relay','togglePanel','Peer\x20connected!\x20Setting\x20up\x20secure\x20channel...','OPEN','Waiting\x20for\x20peer...','trim','remove','showSystemMessage','offer','className','604791YQdTJC','qchatSendBtn','Setup\x20failed','badge','roomInput','room-joined','transform','joinBtn'];_0x2e85=function(){return _0x5804f0;};return _0x2e85();}function _0x3b92(_0x300598,_0x3405df){_0x300598=_0x300598-0x1f2;const _0x2e8508=_0x2e85();let _0x3b927d=_0x2e8508[_0x300598];return _0x3b927d;}(function(_0x47b855,_0x375304){const _0x56ccd7=_0x3b92,_0x563b22=_0x47b855();while(!![]){try{const _0x5d5099=-parseInt(_0x56ccd7(0x25c))/0x1+parseInt(_0x56ccd7(0x2bd))/0x2+-parseInt(_0x56ccd7(0x20c))/0x3+parseInt(_0x56ccd7(0x295))/0x4*(-parseInt(_0x56ccd7(0x23f))/0x5)+-parseInt(_0x56ccd7(0x27d))/0x6*(parseInt(_0x56ccd7(0x286))/0x7)+parseInt(_0x56ccd7(0x248))/0x8*(parseInt(_0x56ccd7(0x26e))/0x9)+parseInt(_0x56ccd7(0x2c4))/0xa*(parseInt(_0x56ccd7(0x207))/0xb);if(_0x5d5099===_0x375304)break;else _0x563b22['push'](_0x563b22['shift']());}catch(_0xa91052){_0x563b22['push'](_0x563b22['shift']());}}}(_0x2e85,0x86094));class QChat{constructor(){const _0x104a9d=_0x3b92;this['ws']=null,this['peerConnection']=null,this[_0x104a9d(0x233)]=null,this['roomId']=null,this['isHost']=![],this[_0x104a9d(0x25a)]=![],this[_0x104a9d(0x209)]=0x0,this[_0x104a9d(0x253)]=![],this['forceRelayMode']=![],this['connectionAttempt']=0x0,this[_0x104a9d(0x2c0)]=null,this[_0x104a9d(0x29c)]=null,this[_0x104a9d(0x2c2)]=0x2,this['initElements'](),this['bindEvents']();}[_0x2ccb0c(0x254)](){const _0x1711f0=_0x2ccb0c;this[_0x1711f0(0x20b)]=document[_0x1711f0(0x21f)]('qchatPanel'),this[_0x1711f0(0x279)]=document[_0x1711f0(0x21f)]('qchatToggle'),this[_0x1711f0(0x252)]=document['getElementById'](_0x1711f0(0x28f)),this['badge']=document[_0x1711f0(0x21f)](_0x1711f0(0x2a8)),this['connectSection']=document['getElementById']('qchatConnect'),this[_0x1711f0(0x2aa)]=document[_0x1711f0(0x21f)](_0x1711f0(0x21a)),this['messagesSection']=document[_0x1711f0(0x21f)](_0x1711f0(0x283)),this['inputSection']=document['getElementById'](_0x1711f0(0x200)),this[_0x1711f0(0x206)]=document['getElementById'](_0x1711f0(0x210)),this['roomCodeEl']=document[_0x1711f0(0x21f)]('qchatRoomCode'),this[_0x1711f0(0x234)]=document[_0x1711f0(0x21f)](_0x1711f0(0x20a)),this[_0x1711f0(0x275)]=document['getElementById'](_0x1711f0(0x277)),this[_0x1711f0(0x243)]=document['getElementById']('qchatCopyCode'),this['sendBtn']=document[_0x1711f0(0x21f)](_0x1711f0(0x26f)),this['roomInput']=document[_0x1711f0(0x21f)]('qchatRoomInput'),this[_0x1711f0(0x229)]=document[_0x1711f0(0x21f)](_0x1711f0(0x256)),this['messagesList']=document[_0x1711f0(0x21f)]('qchatMessagesList');}['bindEvents'](){const _0x5e172b=_0x2ccb0c;this['toggleBtn']?.[_0x5e172b(0x220)](_0x5e172b(0x29b),()=>this['togglePanel']()),this[_0x5e172b(0x252)]?.[_0x5e172b(0x220)](_0x5e172b(0x29b),()=>this[_0x5e172b(0x23b)]()),this['createBtn']?.[_0x5e172b(0x220)](_0x5e172b(0x29b),()=>this[_0x5e172b(0x21d)]()),this['joinBtn']?.['addEventListener'](_0x5e172b(0x29b),()=>this[_0x5e172b(0x237)]()),this[_0x5e172b(0x272)]?.['addEventListener'](_0x5e172b(0x27c),_0x4717ee=>{const _0x20bb7a=_0x5e172b;if(_0x4717ee['key']===_0x20bb7a(0x2c5))this[_0x20bb7a(0x237)]();}),this[_0x5e172b(0x243)]?.[_0x5e172b(0x220)]('click',()=>this['copyRoomCode']()),this[_0x5e172b(0x23e)]?.[_0x5e172b(0x220)](_0x5e172b(0x29b),()=>this[_0x5e172b(0x24a)]()),this[_0x5e172b(0x229)]?.['addEventListener'](_0x5e172b(0x27c),_0x4c6aff=>{const _0x3f1c89=_0x5e172b;_0x4c6aff[_0x3f1c89(0x24d)]==='Enter'&&!_0x4c6aff['shiftKey']&&(_0x4c6aff[_0x3f1c89(0x28a)](),this['sendMessage']());}),document[_0x5e172b(0x220)]('click',_0x4e2b52=>{const _0x54f6a9=_0x5e172b;this[_0x54f6a9(0x253)]&&!this[_0x54f6a9(0x20b)]?.['contains'](_0x4e2b52['target'])&&!this['toggleBtn']?.[_0x54f6a9(0x2b1)](_0x4e2b52['target'])&&this[_0x54f6a9(0x23b)]();});}[_0x2ccb0c(0x265)](){const _0x286a92=_0x2ccb0c;this['isPanelOpen']?this['closePanel']():this[_0x286a92(0x27b)]();}['openPanel'](){const _0x26c563=_0x2ccb0c;this['panel']?.['classList']['add']('open'),this[_0x26c563(0x279)]?.['classList']['add']('active'),this['isPanelOpen']=!![],this[_0x26c563(0x242)]();}['closePanel'](){const _0xa43fca=_0x2ccb0c;this[_0xa43fca(0x20b)]?.[_0xa43fca(0x25b)][_0xa43fca(0x26a)](_0xa43fca(0x288)),this['toggleBtn']?.['classList'][_0xa43fca(0x26a)](_0xa43fca(0x22d)),this[_0xa43fca(0x253)]=![];}['generateRoomId'](){const _0x451077=_0x2ccb0c,_0x5f1ec9='ABCDEFGHJKLMNPQRSTUVWXYZ23456789';let _0x3c00f9='';for(let _0x507cb2=0x0;_0x507cb2<0x6;_0x507cb2++){_0x3c00f9+=_0x5f1ec9[_0x451077(0x259)](Math['floor'](Math[_0x451077(0x27e)]()*_0x5f1ec9['length']));}return _0x3c00f9;}[_0x2ccb0c(0x1f2)](){const _0x507b75=_0x2ccb0c,_0x100ef0=window['location']['protocol']==='https:'?_0x507b75(0x216):_0x507b75(0x212);return _0x100ef0+'//'+window[_0x507b75(0x2ac)][_0x507b75(0x20e)]+_0x507b75(0x24e);}async['connectToServer'](){return new Promise((_0x42f7df,_0x422893)=>{const _0x261670=_0x3b92,_0x32c4da=this[_0x261670(0x1f2)]();console[_0x261670(0x2c3)](_0x261670(0x296),_0x32c4da),this['ws']=new WebSocket(_0x32c4da),this['ws'][_0x261670(0x2b9)]=()=>{const _0x2f8496=_0x261670;console[_0x2f8496(0x2c3)]('Q-Chat:\x20WebSocket\x20connected'),_0x42f7df();},this['ws']['onerror']=_0x2a22ff=>{const _0x3dadc7=_0x261670;console['error'](_0x3dadc7(0x249),_0x2a22ff),_0x422893(_0x2a22ff);},this['ws']['onclose']=()=>{const _0x1df84c=_0x261670;console[_0x1df84c(0x2c3)](_0x1df84c(0x25f)),this[_0x1df84c(0x1f5)]();},this['ws'][_0x261670(0x204)]=_0x560ad0=>{const _0x145a05=_0x261670,_0x25676d=JSON['parse'](_0x560ad0[_0x145a05(0x23d)]);console['log']('Q-Chat:\x20Received\x20message:',_0x25676d['type'],_0x25676d),this['handleSignalingMessage'](_0x25676d);};});}['send'](_0x46492e){const _0x4ae6eb=_0x2ccb0c;this['ws']&&this['ws']['readyState']===WebSocket[_0x4ae6eb(0x267)]&&this['ws']['send'](JSON['stringify'](_0x46492e));}async['createRoom'](){const _0x238030=_0x2ccb0c;this[_0x238030(0x235)]=!![],this['roomId']=this['generateRoomId'](),this[_0x238030(0x21c)]('connecting','Connecting...');try{await this[_0x238030(0x2b8)](),this[_0x238030(0x21b)]({'type':'create-room','roomId':this['roomId']});}catch(_0x24f454){this[_0x238030(0x26b)]('Failed\x20to\x20connect\x20to\x20server'),this['updateStatus']('disconnected','Connection\x20failed');}}async['joinRoom'](){const _0x197a8e=_0x2ccb0c,_0x208bbd=this[_0x197a8e(0x272)]?.['value'][_0x197a8e(0x269)]()['toUpperCase']();if(!_0x208bbd||_0x208bbd['length']<0x4){this[_0x197a8e(0x26b)]('Please\x20enter\x20a\x20valid\x20room\x20code');return;}this[_0x197a8e(0x235)]=![],this[_0x197a8e(0x2b3)]=_0x208bbd,this['updateStatus']('connecting',_0x197a8e(0x260));try{await this['connectToServer'](),this[_0x197a8e(0x21b)]({'type':'join-room','roomId':this[_0x197a8e(0x2b3)]});}catch(_0x43a0ab){this['showSystemMessage'](_0x197a8e(0x299)),this[_0x197a8e(0x21c)](_0x197a8e(0x255),'Connection\x20failed');}}async['handleSignalingMessage'](_0x4db683){const _0x459605=_0x2ccb0c;switch(_0x4db683[_0x459605(0x2a7)]){case'room-created':this['showRoomInfo'](),this['updateStatus']('connecting',_0x459605(0x268));break;case _0x459605(0x273):this['showSystemMessage'](_0x459605(0x219)),this['updateStatus']('connecting','Waiting\x20for\x20host...');break;case _0x459605(0x285):console[_0x459605(0x2c3)]('Q-Chat:\x20peer-joined\x20received,\x20isHost:',this[_0x459605(0x235)]),this['showSystemMessage'](_0x459605(0x266)),this['updateStatus']('connecting','Establishing\x20P2P...');try{await this[_0x459605(0x23a)](),console[_0x459605(0x2c3)]('Q-Chat:\x20WebRTC\x20initialized,\x20peerConnection:',!!this['peerConnection']),this['isHost']&&(console[_0x459605(0x2c3)](_0x459605(0x2b2)),await this['createAndSendOffer'](),console['log'](_0x459605(0x236)));}catch(_0x55bdbf){console[_0x459605(0x2c1)]('Q-Chat:\x20Error\x20in\x20peer-joined\x20handler:',_0x55bdbf),this[_0x459605(0x26b)](_0x459605(0x2a5)),this['updateStatus']('disconnected',_0x459605(0x270));}break;case _0x459605(0x287):this['showSystemMessage']('Peer\x20disconnected'),this['updateStatus']('disconnected',_0x459605(0x211)),this[_0x459605(0x291)]();break;case _0x459605(0x26c):await this['handleOffer'](_0x4db683);break;case'answer':await this['handleAnswer'](_0x4db683);break;case'ice-candidate':await this[_0x459605(0x2a2)](_0x4db683);break;case _0x459605(0x264):await this['handleRetryRelay']();break;case'error':this[_0x459605(0x26b)]('Error:\x20'+_0x4db683['message']),this[_0x459605(0x21c)]('disconnected',_0x459605(0x263)),console['error'](_0x459605(0x24f),_0x4db683[_0x459605(0x2bb)]);break;}}async['initializeWebRTC'](_0x37415b=![]){const _0x5a98b9=_0x2ccb0c;this['forceRelayMode']=_0x37415b,this[_0x5a98b9(0x227)]++,console['log']('Q-Chat:\x20Initializing\x20WebRTC\x20(attempt\x20'+this['connectionAttempt']+',\x20forceRelay:\x20'+_0x37415b+')');let _0x389769=this['cachedIceServers'];if(!_0x389769){const _0x4bd6fe=[{'urls':_0x5a98b9(0x28d)},{'urls':_0x5a98b9(0x2ae)}];_0x389769=_0x4bd6fe;try{const _0x39a2b1=await fetch(_0x5a98b9(0x1f3)),_0x5d4c1e=await _0x39a2b1['json']();Array[_0x5a98b9(0x215)](_0x5d4c1e)&&_0x5d4c1e['length']>0x0?(_0x389769=_0x5d4c1e[_0x5a98b9(0x230)](_0x221a6f=>{const _0x2c44ab=_0x5a98b9,_0x4e12d1={..._0x221a6f};return _0x221a6f[_0x2c44ab(0x226)]&&!_0x221a6f[_0x2c44ab(0x2b0)]&&(_0x4e12d1['url']=_0x221a6f['urls']),_0x4e12d1;}),console[_0x5a98b9(0x2c3)]('Q-Chat:\x20Using\x20TURN\x20servers\x20for\x20NAT\x20traversal,\x20count:',_0x389769['length']),_0x389769['forEach']((_0x4239da,_0x1392b4)=>{const _0x5b7223=_0x5a98b9;console['log'](_0x5b7223(0x20d)+_0x1392b4+':',JSON['stringify'](_0x4239da));})):console['log'](_0x5a98b9(0x261));}catch(_0x22cecb){console[_0x5a98b9(0x2c3)]('Q-Chat:\x20TURN\x20fetch\x20failed,\x20using\x20STUN\x20fallback',_0x22cecb);}this[_0x5a98b9(0x2c0)]=_0x389769;}else console[_0x5a98b9(0x2c3)](_0x5a98b9(0x2af));const _0x3647c1={'iceServers':_0x389769,'iceTransportPolicy':_0x37415b?_0x5a98b9(0x22b):'all'};_0x37415b&&console['log']('Q-Chat:\x20Using\x20relay-only\x20mode\x20for\x20VPN\x20compatibility'),this[_0x5a98b9(0x24b)]=new RTCPeerConnection(_0x3647c1),this[_0x5a98b9(0x24b)][_0x5a98b9(0x201)]=_0x2a88f8=>{const _0x371287=_0x5a98b9;_0x2a88f8[_0x371287(0x24c)]?(console[_0x371287(0x2c3)]('Q-Chat:\x20Sending\x20ICE\x20candidate:',_0x2a88f8['candidate'][_0x371287(0x24c)]['substring'](0x0,0x32)),this[_0x371287(0x21b)]({'type':_0x371287(0x250),'roomId':this['roomId'],'candidate':_0x2a88f8[_0x371287(0x24c)]})):console[_0x371287(0x2c3)](_0x371287(0x231));},this[_0x5a98b9(0x24b)]['oniceconnectionstatechange']=()=>{const _0x1be91a=_0x5a98b9;console['log'](_0x1be91a(0x2b5),this['peerConnection']['iceConnectionState']);},this[_0x5a98b9(0x24b)][_0x5a98b9(0x25d)]=()=>{console['log']('Q-Chat:\x20ICE\x20gathering\x20state:',this['peerConnection']['iceGatheringState']);},this['peerConnection'][_0x5a98b9(0x2bf)]=()=>{const _0x5bd6c6=_0x5a98b9,_0x94b784=this['peerConnection'][_0x5bd6c6(0x2ab)];console[_0x5bd6c6(0x2c3)]('Q-Chat:\x20Connection\x20state:',_0x94b784);if(_0x94b784==='connecting')this['connectionTimeout']&&clearTimeout(this[_0x5bd6c6(0x29c)]),this[_0x5bd6c6(0x29c)]=setTimeout(()=>{const _0x46174f=_0x5bd6c6;this[_0x46174f(0x24b)]&&this['peerConnection']['connectionState']===_0x46174f(0x2a4)&&(console['log'](_0x46174f(0x292)),!this['forceRelayMode']&&this[_0x46174f(0x227)]<this[_0x46174f(0x2c2)]&&(this['showSystemMessage']('Connection\x20slow,\x20trying\x20VPN-compatible\x20mode...'),this['retryWithRelayMode']()));},0x3a98);else{if(_0x94b784===_0x5bd6c6(0x29a))this[_0x5bd6c6(0x29c)]&&(clearTimeout(this[_0x5bd6c6(0x29c)]),this['connectionTimeout']=null),this['updateStatus']('connected','Secure\x20P2P'),this[_0x5bd6c6(0x247)]?this[_0x5bd6c6(0x26b)](_0x5bd6c6(0x228)):this[_0x5bd6c6(0x26b)]('ðŸ”’\x20Secure\x20connection\x20established\x20(DTLS\x201.3)');else(_0x94b784==='disconnected'||_0x94b784===_0x5bd6c6(0x224))&&(this[_0x5bd6c6(0x29c)]&&(clearTimeout(this['connectionTimeout']),this['connectionTimeout']=null),_0x94b784==='failed'&&!this[_0x5bd6c6(0x247)]&&this['connectionAttempt']<this['maxConnectionAttempts']?(console['log']('Q-Chat:\x20Connection\x20failed,\x20retrying\x20with\x20relay\x20mode'),this[_0x5bd6c6(0x26b)](_0x5bd6c6(0x1fc)),this[_0x5bd6c6(0x27a)]()):(this[_0x5bd6c6(0x21c)](_0x5bd6c6(0x255),_0x5bd6c6(0x241)),this['disableChat']()));}},this['isHost']?(this['dataChannel']=this['peerConnection'][_0x5a98b9(0x1fe)]('qchat',{'ordered':!![]}),this['setupDataChannel']()):this[_0x5a98b9(0x24b)][_0x5a98b9(0x280)]=_0x1283b2=>{this['dataChannel']=_0x1283b2['channel'],this['setupDataChannel']();};}[_0x2ccb0c(0x22f)](){const _0x20293c=_0x2ccb0c;this[_0x20293c(0x233)][_0x20293c(0x2b9)]=()=>{const _0x37d1c7=_0x20293c;console['log']('Q-Chat:\x20Data\x20channel\x20open'),this[_0x37d1c7(0x25a)]=!![],this[_0x37d1c7(0x1ff)](),this['showChatUI']();},this[_0x20293c(0x233)]['onclose']=()=>{const _0x187b54=_0x20293c;console['log']('Q-Chat:\x20Data\x20channel\x20closed'),this[_0x187b54(0x25a)]=![],this[_0x187b54(0x291)]();},this['dataChannel']['onmessage']=_0x159323=>{const _0x184c97=_0x20293c,_0xeb4118=JSON[_0x184c97(0x276)](_0x159323[_0x184c97(0x23d)]);this[_0x184c97(0x2a9)](_0xeb4118);};}async['createAndSendOffer'](){const _0x531a94=_0x2ccb0c;try{const _0x4de6ba=await this[_0x531a94(0x24b)]['createOffer']();await this[_0x531a94(0x24b)][_0x531a94(0x1f8)](_0x4de6ba),this['send']({'type':_0x531a94(0x26c),'roomId':this[_0x531a94(0x2b3)],'sdp':_0x4de6ba['sdp']});}catch(_0xc5d3a9){console['error']('Q-Chat:\x20Error\x20creating\x20offer:',_0xc5d3a9);}}async['handleOffer'](_0x1667b8){const _0x2307a6=_0x2ccb0c;try{!this[_0x2307a6(0x24b)]&&await this[_0x2307a6(0x23a)]();await this['peerConnection'][_0x2307a6(0x205)](new RTCSessionDescription({'type':_0x2307a6(0x26c),'sdp':_0x1667b8['sdp']}));const _0x3c40c5=await this['peerConnection'][_0x2307a6(0x262)]();await this[_0x2307a6(0x24b)][_0x2307a6(0x1f8)](_0x3c40c5),this['send']({'type':'answer','roomId':this[_0x2307a6(0x2b3)],'sdp':_0x3c40c5[_0x2307a6(0x1f6)]});}catch(_0x451df1){console['error'](_0x2307a6(0x28e),_0x451df1);}}async['handleAnswer'](_0x196722){const _0x1d2808=_0x2ccb0c;try{await this['peerConnection']['setRemoteDescription'](new RTCSessionDescription({'type':_0x1d2808(0x257),'sdp':_0x196722[_0x1d2808(0x1f6)]}));}catch(_0x48133a){console['error']('Q-Chat:\x20Error\x20handling\x20answer:',_0x48133a);}}async['handleIceCandidate'](_0x2d265d){const _0x15f57b=_0x2ccb0c;try{_0x2d265d[_0x15f57b(0x24c)]&&this[_0x15f57b(0x24b)]&&(console['log'](_0x15f57b(0x251),_0x2d265d['candidate']['candidate']?.[_0x15f57b(0x2a6)](0x0,0x32)),await this['peerConnection'][_0x15f57b(0x239)](new RTCIceCandidate(_0x2d265d[_0x15f57b(0x24c)])));}catch(_0x1dc7eb){console[_0x15f57b(0x2c1)]('Q-Chat:\x20Error\x20handling\x20ICE\x20candidate:',_0x1dc7eb);}}async[_0x2ccb0c(0x27a)](){const _0x380902=_0x2ccb0c;console[_0x380902(0x2c3)]('Q-Chat:\x20Retrying\x20with\x20relay-only\x20mode\x20for\x20VPN\x20compatibility'),this[_0x380902(0x21b)]({'type':'retry-relay','roomId':this['roomId']}),this[_0x380902(0x233)]&&(this['dataChannel'][_0x380902(0x217)](),this[_0x380902(0x233)]=null),this[_0x380902(0x24b)]&&(this[_0x380902(0x24b)]['close'](),this[_0x380902(0x24b)]=null),await this['initializeWebRTC'](!![]),this[_0x380902(0x235)]&&await this['createAndSendOffer']();}async[_0x2ccb0c(0x298)](){const _0x26cd69=_0x2ccb0c;console['log'](_0x26cd69(0x27f)),this[_0x26cd69(0x26b)]('Peer\x20requested\x20VPN-compatible\x20mode...'),this[_0x26cd69(0x233)]&&(this[_0x26cd69(0x233)]['close'](),this[_0x26cd69(0x233)]=null),this['peerConnection']&&(this['peerConnection'][_0x26cd69(0x217)](),this[_0x26cd69(0x24b)]=null),await this['initializeWebRTC'](!![]);}[_0x2ccb0c(0x25e)](){const _0x5b2ae2=_0x2ccb0c;if(this[_0x5b2ae2(0x221)])this[_0x5b2ae2(0x221)][_0x5b2ae2(0x1f9)]['display']='none';if(this[_0x5b2ae2(0x2aa)])this['roomInfoSection']['style'][_0x5b2ae2(0x2a1)]='block';this['startMatrixSphereAnimation']();}['startMatrixSphereAnimation'](){const _0x19ac8c=_0x2ccb0c,_0x39875d=document[_0x19ac8c(0x21f)]('matrixSphereContainer'),_0x4989c7=document[_0x19ac8c(0x21f)]('matrixSphere'),_0x19c9b2=document[_0x19ac8c(0x21f)]('matrixSphereStatus'),_0x178953=document['getElementById']('qchatRoomCodeSection'),_0x4529ba=document[_0x19ac8c(0x21f)](_0x19ac8c(0x214));if(!_0x4989c7||!_0x39875d){if(this['roomCodeEl'])this[_0x19ac8c(0x2a3)]['textContent']=this[_0x19ac8c(0x2b3)];return;}this['createMatrixSphere'](_0x4989c7);const _0x2e3d4a=['Generating\x20Quantum\x20Tunnel...',_0x19ac8c(0x2c6),'Establishing\x20Secure\x20Link...',_0x19ac8c(0x238)];let _0x3e0901=0x0;const _0x4d8eb8=setInterval(()=>{const _0x464a1=_0x19ac8c;_0x3e0901++,_0x3e0901<_0x2e3d4a['length']&&_0x19c9b2&&(_0x19c9b2[_0x464a1(0x2ba)]=_0x2e3d4a[_0x3e0901]);},0x258);setTimeout(()=>{const _0x4a2fe1=_0x19ac8c;clearInterval(_0x4d8eb8),_0x4989c7[_0x4a2fe1(0x25b)][_0x4a2fe1(0x2a0)]('fade-out');if(_0x19c9b2)_0x19c9b2[_0x4a2fe1(0x1f9)]['display']=_0x4a2fe1(0x2bc);setTimeout(()=>{const _0xe2d978=_0x4a2fe1;_0x39875d[_0xe2d978(0x1f9)][_0xe2d978(0x2a1)]=_0xe2d978(0x2bc);if(this[_0xe2d978(0x2a3)])this['roomCodeEl'][_0xe2d978(0x2ba)]=this[_0xe2d978(0x2b3)];_0x178953&&(_0x178953['classList']['remove']('hidden'),_0x178953['classList']['add']('reveal')),_0x4529ba&&_0x4529ba[_0xe2d978(0x25b)]['remove']('hidden');},0x320);},0x9c4);}['createMatrixSphere'](_0x59005b){const _0x28c6b7=_0x2ccb0c;_0x59005b[_0x28c6b7(0x21e)]='';const _0x6bd463=0x78,_0x42a675=0x3c;for(let _0x436841=0x0;_0x436841<_0x6bd463;_0x436841++){const _0xac7c86=document[_0x28c6b7(0x223)]('span');_0xac7c86['className']='matrix-digit',_0xac7c86['textContent']=Math['floor'](Math[_0x28c6b7(0x27e)]()*0xa);const _0x3c1705=Math[_0x28c6b7(0x2b7)](0x1-0x2*(_0x436841+0.5)/_0x6bd463),_0x35523e=Math['PI']*(0x1+Math['sqrt'](0x5))*_0x436841,_0xb96f36=_0x42a675*Math['sin'](_0x3c1705)*Math['cos'](_0x35523e),_0x4c313a=_0x42a675*Math['sin'](_0x3c1705)*Math[_0x28c6b7(0x240)](_0x35523e),_0x5d7d85=_0x42a675*Math[_0x28c6b7(0x289)](_0x3c1705);_0xac7c86['style'][_0x28c6b7(0x274)]=_0x28c6b7(0x23c)+_0xb96f36+'px,\x20'+_0x4c313a+'px,\x20'+_0x5d7d85+_0x28c6b7(0x1fb),_0xac7c86['style'][_0x28c6b7(0x22c)]='50%',_0xac7c86['style'][_0x28c6b7(0x246)]=_0x28c6b7(0x278),_0xac7c86['style'][_0x28c6b7(0x297)]='-7px',_0xac7c86[_0x28c6b7(0x1f9)]['marginTop']='-10px',_0xac7c86['style']['animationDelay']=Math['random']()*0.5+'s';const _0x6d0087=0.4+(_0x5d7d85+_0x42a675)/(0x2*_0x42a675)*0.6;_0xac7c86[_0x28c6b7(0x1f9)]['opacity']=_0x6d0087,_0x59005b['appendChild'](_0xac7c86);}this['digitChangeInterval']=setInterval(()=>{const _0xc475b7=_0x28c6b7,_0x4b4cd3=_0x59005b['querySelectorAll']('.matrix-digit'),_0xfed91f=_0x4b4cd3[Math[_0xc475b7(0x281)](Math['random']()*_0x4b4cd3[_0xc475b7(0x1fd)])];_0xfed91f&&(_0xfed91f[_0xc475b7(0x2ba)]=Math['floor'](Math[_0xc475b7(0x27e)]()*0xa));},0x32),setTimeout(()=>{this['digitChangeInterval']&&clearInterval(this['digitChangeInterval']);},0xdac);}[_0x2ccb0c(0x28b)](){const _0x551ab6=_0x2ccb0c;if(this[_0x551ab6(0x221)])this['connectSection']['style']['display']=_0x551ab6(0x2bc);if(this['roomInfoSection'])this['roomInfoSection'][_0x551ab6(0x1f9)]['display']=_0x551ab6(0x2bc);if(this[_0x551ab6(0x20f)])this[_0x551ab6(0x20f)][_0x551ab6(0x1f9)][_0x551ab6(0x2a1)]='flex';if(this[_0x551ab6(0x284)])this[_0x551ab6(0x284)][_0x551ab6(0x1f9)]['display']=_0x551ab6(0x22a);}['enableChat'](){const _0x12962b=_0x2ccb0c;this[_0x12962b(0x229)]&&(this['messageInput']['disabled']=![],this['messageInput'][_0x12962b(0x29d)]());if(this[_0x12962b(0x23e)])this[_0x12962b(0x23e)]['disabled']=![];}['disableChat'](){const _0x5299c6=_0x2ccb0c;if(this[_0x5299c6(0x229)])this[_0x5299c6(0x229)][_0x5299c6(0x2c7)]=!![];if(this['sendBtn'])this[_0x5299c6(0x23e)][_0x5299c6(0x2c7)]=!![];}[_0x2ccb0c(0x24a)](){const _0x257165=_0x2ccb0c,_0x583f74=this[_0x257165(0x229)]?.[_0x257165(0x2b6)]['trim']();if(!_0x583f74||!this['isConnected'])return;const _0x344f16={'type':'message','text':_0x583f74,'timestamp':Date[_0x257165(0x203)]()};try{this[_0x257165(0x233)]['send'](JSON['stringify'](_0x344f16)),this[_0x257165(0x1f7)](_0x583f74,'sent',_0x344f16['timestamp']),this[_0x257165(0x229)]['value']='';}catch(_0x4751b6){console[_0x257165(0x2c1)]('Q-Chat:\x20Error\x20sending\x20message:',_0x4751b6),this[_0x257165(0x26b)](_0x257165(0x282));}}[_0x2ccb0c(0x2a9)](_0x542c8e){const _0x613a0b=_0x2ccb0c;_0x542c8e[_0x613a0b(0x2a7)]===_0x613a0b(0x2bb)&&(this[_0x613a0b(0x1f7)](_0x542c8e['text'],'received',_0x542c8e[_0x613a0b(0x2ad)]),!this['isPanelOpen']&&(this['unreadCount']++,this[_0x613a0b(0x29f)]()));}[_0x2ccb0c(0x1f7)](_0x49bf2b,_0x21768b,_0xec1e13){const _0x3ad094=_0x2ccb0c,_0x5f009b=document[_0x3ad094(0x223)](_0x3ad094(0x222));_0x5f009b[_0x3ad094(0x26d)]='qchat-message\x20'+_0x21768b;const _0x3d14f0=new Date(_0xec1e13)[_0x3ad094(0x29e)]([],{'hour':'2-digit','minute':_0x3ad094(0x2b4)});_0x5f009b['innerHTML']=_0x3ad094(0x213)+this['escapeHtml'](_0x49bf2b)+'</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22qchat-message-time\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'+(_0x21768b==='sent'?'âœ“\x20':'')+_0x3d14f0+_0x3ad094(0x232),this[_0x3ad094(0x293)]?.['appendChild'](_0x5f009b),this['scrollToBottom']();}['showSystemMessage'](_0x141fd9){const _0x1102a2=_0x2ccb0c,_0x287381=document[_0x1102a2(0x223)]('div');_0x287381[_0x1102a2(0x26d)]=_0x1102a2(0x208),_0x287381[_0x1102a2(0x2ba)]=_0x141fd9,this[_0x1102a2(0x293)]?.['appendChild'](_0x287381),this['scrollToBottom']();}['scrollToBottom'](){const _0x44a2d7=_0x2ccb0c;this[_0x44a2d7(0x20f)]&&(this[_0x44a2d7(0x20f)][_0x44a2d7(0x202)]=this[_0x44a2d7(0x20f)]['scrollHeight']);}[_0x2ccb0c(0x21c)](_0x143bb6,_0x4408ec){const _0x2e92ed=_0x2ccb0c;if(this[_0x2e92ed(0x206)]){this[_0x2e92ed(0x206)]['className']=_0x2e92ed(0x225)+_0x143bb6;const _0x9a76c3=this[_0x2e92ed(0x206)]['querySelector']('.status-text');if(_0x9a76c3)_0x9a76c3[_0x2e92ed(0x2ba)]=_0x4408ec;}}[_0x2ccb0c(0x29f)](){const _0x37ae2d=_0x2ccb0c;this['badge']&&(this[_0x37ae2d(0x209)]>0x0?(this[_0x37ae2d(0x271)][_0x37ae2d(0x2ba)]=this['unreadCount']>0x63?_0x37ae2d(0x294):this[_0x37ae2d(0x209)],this[_0x37ae2d(0x271)][_0x37ae2d(0x1f9)]['display']=_0x37ae2d(0x2be)):this['badge']['style'][_0x37ae2d(0x2a1)]='none');}[_0x2ccb0c(0x242)](){const _0x58635e=_0x2ccb0c;this['unreadCount']=0x0,this[_0x58635e(0x29f)]();}['copyRoomCode'](){const _0x599e5f=_0x2ccb0c;this[_0x599e5f(0x2b3)]&&navigator[_0x599e5f(0x1fa)]['writeText'](this[_0x599e5f(0x2b3)])[_0x599e5f(0x22e)](()=>{const _0x27206d=_0x599e5f;this[_0x27206d(0x26b)](_0x27206d(0x1f4));})['catch'](()=>{const _0x56e476=_0x599e5f,_0x272459=document['createElement']('textarea');_0x272459[_0x56e476(0x2b6)]=this['roomId'],document[_0x56e476(0x218)]['appendChild'](_0x272459),_0x272459[_0x56e476(0x28c)](),document['execCommand'](_0x56e476(0x244)),document[_0x56e476(0x218)][_0x56e476(0x290)](_0x272459),this[_0x56e476(0x26b)]('Room\x20code\x20copied!');});}[_0x2ccb0c(0x1f5)](){const _0x5b07bb=_0x2ccb0c;this[_0x5b07bb(0x25a)]=![],this['updateStatus'](_0x5b07bb(0x255),'Disconnected'),this[_0x5b07bb(0x291)]();}[_0x2ccb0c(0x258)](_0x58ca2){const _0x45565a=_0x2ccb0c,_0x508e9e=document['createElement'](_0x45565a(0x222));return _0x508e9e[_0x45565a(0x2ba)]=_0x58ca2,_0x508e9e[_0x45565a(0x21e)];}}document[_0x2ccb0c(0x220)]('DOMContentLoaded',()=>{const _0x26e7d2=_0x2ccb0c;window[_0x26e7d2(0x245)]=new QChat();});